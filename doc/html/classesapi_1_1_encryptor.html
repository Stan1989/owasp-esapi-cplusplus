<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OWASP ESAPI for C Plus Plus: esapi::Encryptor Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OWASP ESAPI for C Plus Plus
   &#160;<span id="projectnumber">ALPHA</span>
   </div>
   <div id="projectbrief">An API for helping programmers develop more secure business applications in C++</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceesapi.html">esapi</a>      </li>
      <li class="navelem"><a class="el" href="classesapi_1_1_encryptor.html">Encryptor</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">esapi::Encryptor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="esapi::Encryptor" -->
<p><code>#include &lt;<a class="el" href="_encryptor_8h_source.html">Encryptor.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for esapi::Encryptor:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classesapi_1_1_encryptor.png" usemap="#esapi::Encryptor_map" alt=""/>
  <map id="esapi::Encryptor_map" name="esapi::Encryptor_map">
<area href="classesapi_1_1_default_encryptor.html" alt="esapi::DefaultEncryptor" shape="rect" coords="0,56,144,80"/>
</map>
 </div></div>

<p><a href="classesapi_1_1_encryptor-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a2077a4a14bc0d20215d5291fc150b0a4">hash</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;plaintext, const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;salt, unsigned int iterations=4096) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#aa4277d1b966ee147001f881d1b4fdfca">encrypt</a> (const <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> &amp;plaintext) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a4136d905f1e6858967da238751934795">encrypt</a> (const <a class="el" href="classesapi_1_1_secret_key.html">SecretKey</a> &amp;key, const <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> &amp;plaintext) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#adc096b3758748f4b753fbb7c9256fc89">decrypt</a> (const <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> &amp;ciphertext) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a3c280efe85c26f3ae6c85d5f99b1d928">decrypt</a> (const <a class="el" href="classesapi_1_1_secret_key.html">SecretKey</a> &amp;key, const <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> &amp;ciphertext) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a8afd578378112b13b4692131afd832d8">sign</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;data) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a56ebd4b7e9523cf3bf2ae6696ff72f24">verifySignature</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;signature, const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;data) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#affb11398fed735b0f9b19c6823172fc0">seal</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;data, time_t timestamp) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#ae3888747a3e43c7a28a35625daa51c8e">unseal</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;<a class="el" href="classesapi_1_1_encryptor.html#affb11398fed735b0f9b19c6823172fc0">seal</a>) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a8189274b30e5c63599855d79ffe1a30b">verifySeal</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;<a class="el" href="classesapi_1_1_encryptor.html#affb11398fed735b0f9b19c6823172fc0">seal</a>) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#a3ae971b6a17ec95dba735c9775ccc8bc">getRelativeTimeStamp</a> (time_t offset) const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#adf789e32b077a50b8b2b05b479c7b7fd">getTimeStamp</a> () const =0</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encryptor.html#aa5ef07b357dd994f4e6ba0e79dc66e81">~Encryptor</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classesapi_1_1_encryptor.html">Encryptor</a> interface provides a set of methods for performing common encryption, random number, and hashing operations. Implementations should rely on a strong cryptographic implementation, such as Crypto++. Implementors should take care to ensure that they initialize their implementation with a strong "master key", and that they protect this secret as much as possible. </p>
<p>The main property controlling the selection of the implementation class is the property </p>
<div class="fragment"><pre class="fragment"> ESAPI.Encryptor 
</pre></div><p> in </p>
<div class="fragment"><pre class="fragment"> ESAPI.properties 
</pre></div><p> . Most of the the other encryption related properties have property names that start with the string "Encryptor.". These properties all you to do things such as select the encryption algorithms, the key size, etc. </p>
<p>In addition, there are two important properties (initially delivered as unset from the ESAPI download) named </p>
<div class="fragment"><pre class="fragment"> Encryptor.MasterKey 
</pre></div><p> and </p>
<div class="fragment"><pre class="fragment"> Encryptor.MasterSalt 
</pre></div><p> that must be set before using ESAPI encryption. There is a <em>bash</em>(1) shell script provided with the standard ESAPI distribution called 'setMasterKey.sh' that will assist you in setting these two properties. The * script is in 'src/examples/scripts/setMasterKey.sh'. </p>
<p>Possible future enhancements (depending on feedback) are discussed in section 4 of <a href="http://owasp-esapi-java.googlecode.com/svn/trunk/documentation/esapi4java-core-2.0-crypto-design-goals.doc">Design Goals in OWASP ESAPI Cryptography</a>.</p>
<dl class="author"><dt><b>Author:</b></dt><dd><a href="mailto:kevin.w.wall@gmail.com">kevin.w.wall@gmail.com</a> </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>1.0 </dd></dl>

<p>Definition at line <a class="el" href="_encryptor_8h_source.html#l00078">78</a> of file <a class="el" href="_encryptor_8h_source.html">Encryptor.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa5ef07b357dd994f4e6ba0e79dc66e81"></a><!-- doxytag: member="esapi::Encryptor::~Encryptor" ref="aa5ef07b357dd994f4e6ba0e79dc66e81" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classesapi_1_1_encryptor.html#aa5ef07b357dd994f4e6ba0e79dc66e81">esapi::Encryptor::~Encryptor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Do nothing virtual DTOR. </p>

<p>Definition at line <a class="el" href="_encryptor_8h_source.html#l00320">320</a> of file <a class="el" href="_encryptor_8h_source.html">Encryptor.h</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="adc096b3758748f4b753fbb7c9256fc89"></a><!-- doxytag: member="esapi::Encryptor::decrypt" ref="adc096b3758748f4b753fbb7c9256fc89" args="(const CipherText &amp;ciphertext) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> <a class="el" href="classesapi_1_1_encryptor.html#adc096b3758748f4b753fbb7c9256fc89">esapi::Encryptor::decrypt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> &amp;&#160;</td>
          <td class="paramname"><em>ciphertext</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decrypts the provided <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> using the information from it and the <em>master encryption key</em> as specified by the property </p>
<div class="fragment"><pre class="fragment"> Encryptor.MasterKey 
</pre></div><p> as defined in the </p>
<div class="fragment"><pre class="fragment"> ESAPI.properties 
</pre></div><p> file.  </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ciphertext</td><td>The <div class="fragment"><pre class="fragment"> CipherText 
</pre></div> object to be decrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <div class="fragment"><pre class="fragment"> PlainText 
</pre></div> object resulting from decrypting the specified ciphertext. Note that it it is desired to convert the returned plaintext byte array to a String is should be done using <div class="fragment"><pre class="fragment"> <span class="keyword">new</span> <a class="code" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>(<a class="code" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>[], <span class="stringliteral">&quot;UTF-8&quot;</span>); 
</pre></div> rather than simply using <div class="fragment"><pre class="fragment"> <span class="keyword">new</span> <a class="code" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>(<a class="code" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>[]); 
</pre></div> which uses native encoding and may not be portable across hardware and/or OS platforms. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>Thrown if something should go wrong such as the crypto provider cannot be found, the cipher algorithm, cipher mode, or padding scheme not being supported, specifying an unsupported key size, or incorrect encryption key was specified or a <div class="fragment"><pre class="fragment"> PaddingException 
</pre></div> occurs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd>#decrypt(SecretKey, CipherText) </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a6fb7f79769372077e52677f3b701f525">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a3c280efe85c26f3ae6c85d5f99b1d928"></a><!-- doxytag: member="esapi::Encryptor::decrypt" ref="a3c280efe85c26f3ae6c85d5f99b1d928" args="(const SecretKey &amp;key, const CipherText &amp;ciphertext) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> <a class="el" href="classesapi_1_1_encryptor.html#adc096b3758748f4b753fbb7c9256fc89">esapi::Encryptor::decrypt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_secret_key.html">SecretKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> &amp;&#160;</td>
          <td class="paramname"><em>ciphertext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decrypts the provided <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> using the information from it and the <em>specified secret key</em>. </p>
<p>This decrypt method is similar to <a class="el" href="">decrypt(CipherText)</a> except that it allows decrypting with a secret key other than the <em>master secret key</em>.  </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The <div class="fragment"><pre class="fragment"> SecretKey 
</pre></div> to use for encrypting the plaintext. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>The <div class="fragment"><pre class="fragment"> CipherText 
</pre></div> object to be decrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The <div class="fragment"><pre class="fragment"> PlainText 
</pre></div> object resulting from decrypting the specified ciphertext. Note that it it is desired to convert the returned plaintext byte array to a String is should be done using <div class="fragment"><pre class="fragment"> <span class="keyword">new</span> <a class="code" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>(<a class="code" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>[], <span class="stringliteral">&quot;UTF-8&quot;</span>); 
</pre></div> rather than simply using <div class="fragment"><pre class="fragment"> <span class="keyword">new</span> <a class="code" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>(<a class="code" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>[]); 
</pre></div> which uses native encoding and may not be portable across hardware and/or OS platforms. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>Thrown if something should go wrong such as the crypto provider cannot be found, the cipher algorithm, cipher mode, or padding scheme not being supported, specifying an unsupported key size, or incorrect encryption key was specified or a <div class="fragment"><pre class="fragment"> PaddingException 
</pre></div> occurs. </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd>#decrypt(CipherText) </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a296199a80e84abef88b9892d01446ff7">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="aa4277d1b966ee147001f881d1b4fdfca"></a><!-- doxytag: member="esapi::Encryptor::encrypt" ref="aa4277d1b966ee147001f881d1b4fdfca" args="(const PlainText &amp;plaintext) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> <a class="el" href="classesapi_1_1_encryptor.html#aa4277d1b966ee147001f881d1b4fdfca">esapi::Encryptor::encrypt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> &amp;&#160;</td>
          <td class="paramname"><em>plaintext</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encrypts the provided plaintext bytes using the cipher transformation specified by the property <code>Encryptor.CipherTransformation</code> and the <em>master encryption key</em> as specified by the property </p>
<div class="fragment"><pre class="fragment"> Encryptor.MasterKey 
</pre></div><p> as defined in the <code>ESAPI.properties</code> file.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">plaintext</td><td>The <div class="fragment"><pre class="fragment"> PlainText 
</pre></div> to be encrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the <div class="fragment"><pre class="fragment"> CipherText 
</pre></div> object from which the raw ciphertext, the IV, the cipher transformation, and many other aspects about the encryption detail may be extracted. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>Thrown if something should go wrong such as the crypto provider cannot be found, the cipher algorithm, cipher mode, or padding scheme not being supported, specifying an unsupported key size, specifying an IV of incorrect length, etc. </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd>#encrypt(SecretKey, PlainText) </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a0a4bb6083a85e928242c1e84cdd1b866">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a4136d905f1e6858967da238751934795"></a><!-- doxytag: member="esapi::Encryptor::encrypt" ref="a4136d905f1e6858967da238751934795" args="(const SecretKey &amp;key, const PlainText &amp;plaintext) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classesapi_1_1_cipher_text.html">CipherText</a> <a class="el" href="classesapi_1_1_encryptor.html#aa4277d1b966ee147001f881d1b4fdfca">esapi::Encryptor::encrypt</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_secret_key.html">SecretKey</a> &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_plain_text.html">PlainText</a> &amp;&#160;</td>
          <td class="paramname"><em>plaintext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encrypts the provided plaintext bytes using the cipher transformation specified by the property <code>Encryptor.CipherTransformation</code> as defined in the <code>ESAPI.properties</code> file and the <em>specified secret key</em>. </p>
<p>This method is similar to <a class="el" href="">encrypt(PlainText)</a> except that it permits a specific </p>
<div class="fragment"><pre class="fragment"> SecretKey 
</pre></div><p> to be used for encryption.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The <div class="fragment"><pre class="fragment"> SecretKey 
</pre></div> to use for encrypting the plaintext. </td></tr>
    <tr><td class="paramname">plaintext</td><td>The byte stream to be encrypted. Note if a <div class="fragment"><pre class="fragment"> <a class="code" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> 
</pre></div> is to be encrypted, it should be converted using <div class="fragment"><pre class="fragment"> <span class="stringliteral">&quot;some string&quot;</span>.getBytes(<span class="stringliteral">&quot;UTF-8&quot;</span>) 
</pre></div> . </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the <div class="fragment"><pre class="fragment"> CipherText 
</pre></div> object from which the raw ciphertext, the IV, the cipher transformation, and many other aspects about the encryption detail may be extracted. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>Thrown if something should go wrong such as the crypto provider cannot be found, the cipher algorithm, cipher mode, or padding scheme not being supported, specifying an unsupported key size, specifying an IV of incorrect length, etc. </td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd>#encrypt(PlainText) </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a92de477970e70dc27fc1a04c841a40ae">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a3ae971b6a17ec95dba735c9775ccc8bc"></a><!-- doxytag: member="esapi::Encryptor::getRelativeTimeStamp" ref="a3ae971b6a17ec95dba735c9775ccc8bc" args="(time_t offset) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual long <a class="el" href="classesapi_1_1_encryptor.html#a3ae971b6a17ec95dba735c9775ccc8bc">esapi::Encryptor::getRelativeTimeStamp</a> </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets an absolute timestamp representing an offset from the current time to be used by other functions in the library.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>the offset to add to the current time</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the absolute timestamp </dd></dl>

</div>
</div>
<a class="anchor" id="adf789e32b077a50b8b2b05b479c7b7fd"></a><!-- doxytag: member="esapi::Encryptor::getTimeStamp" ref="adf789e32b077a50b8b2b05b479c7b7fd" args="() const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual long <a class="el" href="classesapi_1_1_encryptor.html#adf789e32b077a50b8b2b05b479c7b7fd">esapi::Encryptor::getTimeStamp</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets a timestamp representing the current date and time to be used by other functions in the library.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a timestamp representing the current time </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a5e853c873c8df44d874fbbeafb555ea6">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a2077a4a14bc0d20215d5291fc150b0a4"></a><!-- doxytag: member="esapi::Encryptor::hash" ref="a2077a4a14bc0d20215d5291fc150b0a4" args="(const String &amp;plaintext, const String &amp;salt, unsigned int iterations=4096) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encryptor.html#a2077a4a14bc0d20215d5291fc150b0a4">esapi::Encryptor::hash</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>iterations</em> = <code>4096</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns a string representation of the hash of the provided plaintext and salt. The salt helps to protect against a rainbow table attack by mixing in some extra data with the plaintext. Some good choices for a salt might be an account name or some other string that is known to the application but not to an attacker. See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">this article</a> for more information about hashing as it pertains to password schemes.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">plaintext</td><td>the plaintext String to encrypt </td></tr>
    <tr><td class="paramname">salt</td><td>the salt to add to the plaintext String before hashing </td></tr>
    <tr><td class="paramname">iterations</td><td>the number of times to iterate the hash</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the encrypted hash of 'plaintext' stored as a String</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>if the specified hash algorithm could not be found or another problem exists with the hashing of 'plaintext' </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a0d084bf8d2f92bfbdaa141b0fb8fb955">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="affb11398fed735b0f9b19c6823172fc0"></a><!-- doxytag: member="esapi::Encryptor::seal" ref="affb11398fed735b0f9b19c6823172fc0" args="(const String &amp;data, time_t timestamp) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encryptor.html#affb11398fed735b0f9b19c6823172fc0">esapi::Encryptor::seal</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a seal that binds a set of data and includes an expiration timestamp.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>the data to seal </td></tr>
    <tr><td class="paramname">timestamp</td><td>the absolute expiration date of the data, expressed as seconds since the epoch</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the seal </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_integrity_exception.html">IntegrityException</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8afd578378112b13b4692131afd832d8"></a><!-- doxytag: member="esapi::Encryptor::sign" ref="a8afd578378112b13b4692131afd832d8" args="(const String &amp;data) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encryptor.html#a8afd578378112b13b4692131afd832d8">esapi::Encryptor::sign</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a digital signature for the provided data and return it in a string. </p>
<p><b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital signatures with this method and <a class="el" href="">verifySignature(const String&amp;, const String&amp;)</a> are dynamically created when the default reference implementation class, <a class="el" href="">ref::DefaultEncryptor</a> is first created. Because this key pair is not persisted nor is the public key shared, this method and the corresponding <a class="el" href="">verifySignature(const String&amp;, const String&amp;)</a> can not be used with expected results across JVM instances. This limitation will be addressed in ESAPI 2.1. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>the data to sign</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the digital signature stored as a String</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>if the specified signature algorithm cannot be found </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a1658a1ebcb8d97c94ea4720555cb32a0">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="ae3888747a3e43c7a28a35625daa51c8e"></a><!-- doxytag: member="esapi::Encryptor::unseal" ref="ae3888747a3e43c7a28a35625daa51c8e" args="(const String &amp;seal) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encryptor.html#ae3888747a3e43c7a28a35625daa51c8e">esapi::Encryptor::unseal</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>seal</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unseals data (created with the seal method) and throws an exception describing any of the various problems that could exist with a seal, such as an invalid seal format, expired timestamp, or decryption error.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seal</td><td>the sealed data</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the original (unsealed) data</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encryption_exception.html">EncryptionException</a></td><td>if the unsealed data cannot be retrieved for any reason </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#ae347f5d966f42fd01a6bd542e4c2aa30">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a8189274b30e5c63599855d79ffe1a30b"></a><!-- doxytag: member="esapi::Encryptor::verifySeal" ref="a8189274b30e5c63599855d79ffe1a30b" args="(const String &amp;seal) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="classesapi_1_1_encryptor.html#a8189274b30e5c63599855d79ffe1a30b">esapi::Encryptor::verifySeal</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>seal</em></td><td>)</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Verifies a seal (created with the seal method) and throws an exception describing any of the various problems that could exist with a seal, such as an invalid seal format, expired timestamp, or data mismatch.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">seal</td><td>the seal to verify</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true, if the seal is valid. False otherwise </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#aedd4d33bc0944ebe68bf546889243a1e">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<a class="anchor" id="a56ebd4b7e9523cf3bf2ae6696ff72f24"></a><!-- doxytag: member="esapi::Encryptor::verifySignature" ref="a56ebd4b7e9523cf3bf2ae6696ff72f24" args="(const String &amp;signature, const String &amp;data) const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool <a class="el" href="classesapi_1_1_encryptor.html#a56ebd4b7e9523cf3bf2ae6696ff72f24">esapi::Encryptor::verifySignature</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>signature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Verifies a digital signature (created with the sign method) and returns the boolean result. </p>
<p><b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital signatures with this method and <a class="el" href="">sign(const String&amp;)</a> are dynamically created when the default reference implementation class, <a class="el" href="">ref::DefaultEncryptor</a> is first created. Because this key pair is not persisted nor is the public key shared, this method and the corresponding <a class="el" href="">sign(const String&amp;)</a> can not be used with expected results across JVM instances. This limitation will be addressed in ESAPI 2.1.  </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">signature</td><td>the signature to verify against 'data' </td></tr>
    <tr><td class="paramname">data</td><td>the data to verify against 'signature'</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>true, if the signature is verified, false otherwise </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encryptor.html#a939ae3fd3efe62827cd4d43a80487eb6">esapi::DefaultEncryptor</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>esapi/<a class="el" href="_encryptor_8h_source.html">Encryptor.h</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 21 2012 12:32:26 for OWASP ESAPI for C Plus Plus by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
