<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OWASP ESAPI for C Plus Plus: esapi::Encoder Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OWASP ESAPI for C Plus Plus
   &#160;<span id="projectnumber">ALPHA</span>
   </div>
   <div id="projectbrief">An API for helping programmers develop more secure business applications in C++</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceesapi.html">esapi</a>      </li>
      <li class="navelem"><a class="el" href="classesapi_1_1_encoder.html">Encoder</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">esapi::Encoder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="esapi::Encoder" -->
<p><code>#include &lt;<a class="el" href="_encoder_8h_source.html">Encoder.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for esapi::Encoder:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classesapi_1_1_encoder.png" usemap="#esapi::Encoder_map" alt=""/>
  <map id="esapi::Encoder_map" name="esapi::Encoder_map">
<area href="classesapi_1_1_default_encoder.html" alt="esapi::DefaultEncoder" shape="rect" coords="0,56,136,80"/>
</map>
 </div></div>

<p><a href="classesapi_1_1_encoder-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">canonicalize</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a0ed21e50b0b2f83be9622bbc4d057fc6">canonicalize</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;, bool)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a3c453a0c19f40cbb6beeeb7a43ccc88d">canonicalize</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;, bool, bool)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#ac0aa1cd3675ed346b33d01adb0d176f1">encodeForCSS</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a9f7bce7d95d8d0a09bd6d2c75ccc864b">encodeForHTML</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#aa38dc6bf1f0fa445f02f5b7a6a0be56c">decodeForHTML</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#af0112bed8b168464675026461c1a33bf">encodeForHTMLAttribute</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#aef7e740033a561cc81b98903bf855d4e">encodeForJavaScript</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a7fbff87c7ff2ad01ee9d9daf8ddea81c">encodeForVBScript</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a1ef7ec24b9432a4fe7adee101d9acb93">encodeForSQL</a> (const <a class="el" href="classesapi_1_1_codec.html">Codec</a> &amp;, const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a7115803e369dd5c69e85170226857e06">encodeForOS</a> (const <a class="el" href="classesapi_1_1_codec.html">Codec</a> *, const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a9907443dae29080fa0d22894b2490544">encodeForLDAP</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a9fbfeff8b6c9b8af23162deeffe9cb77">encodeForDN</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a375aae54ac47014bc48ee5d99d63c934">encodeForXPath</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a46781e1e79035e5d91ba19c6b15ba9df">encodeForXML</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a95df8e50a41f512ac0eae3d127cbd3c6">encodeForXMLAttribute</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a1c3f79c8da8b96b9b832375002fa7a39">encodeForURL</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0  throw (EncodingException)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#ac1dc35d96a593ee2c89ee84264adf1e5">decodeFromURL</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0  throw (EncodingException)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#aba13e8ef512082226c9ebf5add6d9005">encodeForBase64</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;, bool)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_encoder.html#a084f2c10234535a7e3234a4800ba73f8">decodeFromBase64</a> (const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;)=0</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The <a class="el" href="classesapi_1_1_encoder.html">Encoder</a> interface contains a number of methods for decoding input and encoding output so that it will be safe for a variety of interpreters. To prevent double-encoding, callers should make sure input does not already contain encoded characters by calling canonicalize. <a class="el" href="classesapi_1_1_validator.html">Validator</a> implementations should call canonicalize on user input <b>before</b> validating to prevent encoded attacks. </p>
<p>All of the methods must use a "whitelist" or "positive" security model. For the encoding methods, this means that all characters should be encoded, except for a specific list of "immune" characters that are known to be safe. </p>
<p>The <a class="el" href="classesapi_1_1_encoder.html">Encoder</a> performs two key functions, encoding and decoding. These functions rely on a set of codecs that can be found in the org.owasp.esapi.codecs package. These include: </p>
<ul>
<li>
CSS Escaping </li>
<li>
HTMLEntity Encoding </li>
<li>
JavaScript Escaping </li>
<li>
MySQL Escaping </li>
<li>
Oracle Escaping </li>
<li>
Percent Encoding (aka URL Encoding) </li>
<li>
Unix Escaping </li>
<li>
VBScript Escaping </li>
<li>
Windows Encoding</li>
</ul>
<dl class="author"><dt><b>Author:</b></dt><dd>Jeff Williams (jeff.williams .at. aspectsecurity.com) <a href="http://www.aspectsecurity.com">Aspect Security</a> </dd>
<dd>
Dan Amodio (<a href="mailto:dan.amodio@aspectsecurity.com">dan.amodio@aspectsecurity.com</a>) </dd></dl>
<dl class="since"><dt><b>Since:</b></dt><dd>June 1, 2007 </dd></dl>

<p>Definition at line <a class="el" href="_encoder_8h_source.html#l00053">53</a> of file <a class="el" href="_encoder_8h_source.html">Encoder.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a304790d1cc92f19c44a00721f156b039"></a><!-- doxytag: member="esapi::Encoder::canonicalize" ref="a304790d1cc92f19c44a00721f156b039" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">esapi::Encoder::canonicalize</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method is equivalent to calling </p>
<pre>Encoder.canonicalize(input, restrictMultiple, restrictMixed);</pre><p>The default values for restrictMultiple and restrictMixed come from ESAPI.properties </p>
<pre>
 Encoder.AllowMultipleEncoding=false
 Encoder.AllowMixedEncoding=false
 </pre><dl class="see"><dt><b>See also:</b></dt><dd>Encoder::canonicalize(String, bool, bool) <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">canonicalize</a> </dd>
<dd>
<a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to canonicalize </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a String containing the canonicalized text </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a3c7613e8b37b4857722ec89837a7208d">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a0ed21e50b0b2f83be9622bbc4d057fc6"></a><!-- doxytag: member="esapi::Encoder::canonicalize" ref="a0ed21e50b0b2f83be9622bbc4d057fc6" args="(const String &amp;, bool)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">esapi::Encoder::canonicalize</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This method is the equivalent to calling </p>
<pre>Encoder.canonicalize(input, strict, strict);</pre><dl class="see"><dt><b>See also:</b></dt><dd>Encoder::canonicalize(String, bool, bool) <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">canonicalize</a> </dd>
<dd>
<a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to canonicalize </td></tr>
    <tr><td class="paramname">strict</td><td>true if checking for multiple and mixed encoding is desired, false otherwise</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a String containing the canonicalized text </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a6f458922349ce763953dcbbd4632f470">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a3c453a0c19f40cbb6beeeb7a43ccc88d"></a><!-- doxytag: member="esapi::Encoder::canonicalize" ref="a3c453a0c19f40cbb6beeeb7a43ccc88d" args="(const String &amp;, bool, bool)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">esapi::Encoder::canonicalize</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Canonicalization is simply the operation of reducing a possibly encoded string down to its simplest form. This is important, because attackers frequently use encoding to change their input in a way that will bypass validation filters, but still be interpreted properly by the target of the attack. Note that data encoded more than once is not something that a normal user would generate and should be regarded as an attack. </p>
<p>Everyone <a href="http://cwe.mitre.org/data/definitions/180.html">says</a> you shouldn't do validation without canonicalizing the data first. This is easier said than done. The canonicalize method can be used to simplify just about any input down to its most basic form. Note that canonicalize doesn't handle Unicode issues, it focuses on higher level encoding and escaping schemes. In addition to simple decoding, canonicalize also handles: </p>
<ul>
<li>
Perverse but legal variants of escaping schemes </li>
<li>
Multiple escaping (%2526 or &amp;#x26;lt;) </li>
<li>
Mixed escaping (%26lt;) </li>
<li>
Nested escaping (%%316 or &amp;%6ct;) </li>
<li>
All combinations of multiple, mixed, and nested encoding/escaping (%2&amp;#x35;3c or &amp;#x2526gt;)</li>
</ul>
<p>Using canonicalize is simple. The default is just... </p>
<pre>
     String clean = ESAPI.encoder().canonicalize( request.getParameter(L"input"));
 </pre><p> You need to decode untrusted data so that it's safe for ANY downstream interpreter or decoder. For example, if your data goes into a Windows command shell, then into a database, and then to a browser, you're going to need to decode for all of those systems. You can build a custom encoder to canonicalize for your application like this... </p>
<pre>
     ArrayList list = new ArrayList();
     list.add( new WindowsCodec() );
     list.add( new MySQLCodec() );
     list.add( new PercentCodec() );
     <a class="el" href="classesapi_1_1_encoder.html">Encoder</a> encoder = new DefaultEncoder( list );
     String clean = encoder.canonicalize( request.getParameter( "input" ));
 </pre><p> In ESAPI, the <a class="el" href="classesapi_1_1_validator.html">Validator</a> uses the canonicalize method before it does validation. So all you need to do is to validate as normal and you'll be protected against a host of encoded attacks. </p>
<pre>
     String input = request.getParameter( "name" );
     String name = ESAPI.validator().isValidInput( "test", input, "FirstName", 20, false);
 </pre><p> However, the default <a class="el" href="classesapi_1_1_encoder.html#a304790d1cc92f19c44a00721f156b039">canonicalize()</a> method only decodes HTMLEntity, percent (URL) encoding, and JavaScript encoding. If you'd like to use a custom canonicalizer with your validator, that's pretty easy too. </p>
<pre>
     ... setup custom encoder as above
     <a class="el" href="classesapi_1_1_validator.html">Validator</a> validator = new DefaultValidator( encoder );
     String input = request.getParameter( "name" );
     String name = validator.isValidInput( "test", input, "name", 20, false);
 </pre><p> Although ESAPI is able to canonicalize multiple, mixed, or nested encoding, it's safer to not accept this stuff in the first place. In ESAPI, the default is "strict" mode that throws an <a class="el" href="classesapi_1_1_intrusion_exception.html">IntrusionException</a> if it receives anything not single-encoded with a single scheme. This is configurable in ESAPI.properties using the properties: </p>
<pre>
 Encoder.AllowMultipleEncoding=false
 Encoder.AllowMixedEncoding=false
 </pre><p> This method allows you to override the default behavior by directly specifying whether to restrict multiple or mixed encoding. Even if you disable restrictions, you'll still get warning messages in the log about each multiple encoding and mixed encoding received. </p>
<pre>
     // disabling strict mode to allow mixed encoding
     String url = ESAPI.encoder().canonicalize( request.getParameter(L"url"), false, false);
 </pre><dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4">W3C specifications</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to canonicalize </td></tr>
    <tr><td class="paramname">restrictMultiple</td><td>true if checking for multiple encoding is desired, false otherwise </td></tr>
    <tr><td class="paramname">restrictMixed</td><td>true if checking for mixed encoding is desired, false otherwise</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a String containing the canonicalized text </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#ab8a22a0f7a52c068f3ad11ae39962f55">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="aa38dc6bf1f0fa445f02f5b7a6a0be56c"></a><!-- doxytag: member="esapi::Encoder::decodeForHTML" ref="aa38dc6bf1f0fa445f02f5b7a6a0be56c" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#aa38dc6bf1f0fa445f02f5b7a6a0be56c">esapi::Encoder::decodeForHTML</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decodes HTML entities. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the <code>String</code> to decode </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the newly decoded <code>String</code> </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a7aaf59ea3f638255a3151e0107fc2072">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a084f2c10234535a7e3234a4800ba73f8"></a><!-- doxytag: member="esapi::Encoder::decodeFromBase64" ref="a084f2c10234535a7e3234a4800ba73f8" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a084f2c10234535a7e3234a4800ba73f8">esapi::Encoder::decodeFromBase64</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode data encoded with BASE-64 encoding.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the Base64 text to decode</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input decoded from Base64</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">IOException</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#aa1bfae4224ab441a8a6d7bc8c813a851">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="ac1dc35d96a593ee2c89ee84264adf1e5"></a><!-- doxytag: member="esapi::Encoder::decodeFromURL" ref="ac1dc35d96a593ee2c89ee84264adf1e5" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#ac1dc35d96a593ee2c89ee84264adf1e5">esapi::Encoder::decodeFromURL</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td>  throw (<a class="el" href="classesapi_1_1_encoding_exception.html">EncodingException</a>)<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode from URL. Implementations should first canonicalize and detect any double-encoding. If this check passes, then the data is decoded using URL decoding.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to decode from an encoded URL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the decoded URL value</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encoding_exception.html">EncodingException</a></td><td>if decoding fails </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a1377ef862fc335d7941811318d2862c5">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="aba13e8ef512082226c9ebf5add6d9005"></a><!-- doxytag: member="esapi::Encoder::encodeForBase64" ref="aba13e8ef512082226c9ebf5add6d9005" args="(const String &amp;, bool)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#aba13e8ef512082226c9ebf5add6d9005">esapi::Encoder::encodeForBase64</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for Base64.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for Base64 </td></tr>
    <tr><td class="paramname">wrap</td><td>the encoder will wrap lines every 64 characters of output</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for Base64 </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a571c212eb3bcf065ee0ca94f2c00398e">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="ac0aa1cd3675ed346b33d01adb0d176f1"></a><!-- doxytag: member="esapi::Encoder::encodeForCSS" ref="ac0aa1cd3675ed346b33d01adb0d176f1" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#ac0aa1cd3675ed346b33d01adb0d176f1">esapi::Encoder::encodeForCSS</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in Cascading Style Sheets (CSS) content.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3.org/TR/CSS21/syndata.html#escaped-characters">CSS Syntax [w3.org]</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for CSS</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for CSS </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a62fc4a8a3d284fdbf8e26565d032dcf7">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a9fbfeff8b6c9b8af23162deeffe9cb77"></a><!-- doxytag: member="esapi::Encoder::encodeForDN" ref="a9fbfeff8b6c9b8af23162deeffe9cb77" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a9fbfeff8b6c9b8af23162deeffe9cb77">esapi::Encoder::encodeForDN</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an LDAP distinguished name.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for an LDAP distinguished name</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in an LDAP distinguished name </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#af67d041fb6c1e4ce2944234af175377f">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a9f7bce7d95d8d0a09bd6d2c75ccc864b"></a><!-- doxytag: member="esapi::Encoder::encodeForHTML" ref="a9f7bce7d95d8d0a09bd6d2c75ccc864b" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a9f7bce7d95d8d0a09bd6d2c75ccc864b">esapi::Encoder::encodeForHTML</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in HTML using HTML entity encoding </p>
<p>Note that the following characters: 00-08, 0B-0C, 0E-1F, and 7F-9F </p>
<p>cannot be used in HTML.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://en.wikipedia.org/wiki/Character_encodings_in_HTML">HTML Encodings [wikipedia.org]</a> </dd>
<dd>
<a href="http://www.w3.org/TR/html4/sgml/sgmldecl.html">SGML Specification [w3.org]</a> </dd>
<dd>
<a href="http://www.w3.org/TR/REC-xml/#charsets">XML Specification [w3.org]</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for HTML</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for HTML </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a50b6a4e391d6dfa97ae6f1652bcf3a8f">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="af0112bed8b168464675026461c1a33bf"></a><!-- doxytag: member="esapi::Encoder::encodeForHTMLAttribute" ref="af0112bed8b168464675026461c1a33bf" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#af0112bed8b168464675026461c1a33bf">esapi::Encoder::encodeForHTMLAttribute</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in HTML attributes.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for an HTML attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use as an HTML attribute </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a4f5fb212e0f67251995101ab5cde36fa">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="aef7e740033a561cc81b98903bf855d4e"></a><!-- doxytag: member="esapi::Encoder::encodeForJavaScript" ref="aef7e740033a561cc81b98903bf855d4e" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#aef7e740033a561cc81b98903bf855d4e">esapi::Encoder::encodeForJavaScript</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for insertion inside a data value or function argument in JavaScript. Including user data directly inside a script is quite dangerous. Great care must be taken to prevent including user data directly into script code itself, as no amount of encoding will prevent attacks there.</p>
<p>Please note there are some JavaScript functions that can never safely receive untrusted data as input - even if the user input is encoded.</p>
<p>For example:</p>
<p>&lt;script&gt; window.setInterval(L'&lt;%= EVEN IF YOU ENCODE UNTRUSTED DATA YOU ARE XSSED HERE %&gt;'); &lt;/script&gt;</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for JavaScript</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in JavaScript </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a91a6f2a14737ff38b5ecbd4e0db1b62e">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a9907443dae29080fa0d22894b2490544"></a><!-- doxytag: member="esapi::Encoder::encodeForLDAP" ref="a9907443dae29080fa0d22894b2490544" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a9907443dae29080fa0d22894b2490544">esapi::Encoder::encodeForLDAP</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in LDAP queries.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for LDAP</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in LDAP </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a1f61bdffef8d2150a0aa6197e685505a">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a7115803e369dd5c69e85170226857e06"></a><!-- doxytag: member="esapi::Encoder::encodeForOS" ref="a7115803e369dd5c69e85170226857e06" args="(const Codec *, const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a7115803e369dd5c69e85170226857e06">esapi::Encoder::encodeForOS</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_codec.html">Codec</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for an operating system command shell according to the selected codec (appropriate codecs include the <a class="el" href="classesapi_1_1_windows_codec.html">WindowsCodec</a> and <a class="el" href="classesapi_1_1_unix_codec.html">UnixCodec</a>).</p>
<p>Please note the following recommendations before choosing to use this method:</p>
<p>1) It is strongly recommended that applications avoid making direct OS system calls if possible as such calls are not portable, and they are potentially unsafe. Please use language provided features if at all possible, rather than native OS calls to implement the desired feature. 2) If an OS call cannot be avoided, then it is recommended that the program to be invoked be invoked directly (e.g., System.exec(L"nameofcommand" + "parameterstocommand");) as this avoids the use of the command shell. The "parameterstocommand" should of course be validated before passing them to the OS command. 3) If you must use this method, then we recommend validating all user supplied input passed to the command shell as well, in addition to using this method in order to make the command shell invocation safe.</p>
<p>An example use of this method would be: System.exec(L"dir " + ESAPI.encodeForOS(<a class="el" href="classesapi_1_1_windows_codec.html">WindowsCodec</a>, "parameter(s)tocommandwithuserinput");</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">codec</td><td>a <a class="el" href="classesapi_1_1_codec.html">Codec</a> that declares which operating system 'input' is being encoded for (ie. Windows, Unix, etc.) </td></tr>
    <tr><td class="paramname">input</td><td>the text to encode for the command shell</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in command shell </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a3ff88fea77c3f18c6dcf6f2708049c2f">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a1ef7ec24b9432a4fe7adee101d9acb93"></a><!-- doxytag: member="esapi::Encoder::encodeForSQL" ref="a1ef7ec24b9432a4fe7adee101d9acb93" args="(const Codec &amp;, const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a1ef7ec24b9432a4fe7adee101d9acb93">esapi::Encoder::encodeForSQL</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classesapi_1_1_codec.html">Codec</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode input for use in a SQL query, according to the selected codec (appropriate codecs include the <a class="el" href="classesapi_1_1_my_s_q_l_codec.html">MySQLCodec</a> and OracleCodec).</p>
<p>This method is not recommended. The use of the PreparedStatement interface is the preferred approach. However, if for some reason this is impossible, then this method is provided as a weaker alternative.</p>
<p>The best approach is to make sure any single-quotes are double-quoted. Another possible approach is to use the {escape} syntax described in the JDBC specification in section 1.5.6.</p>
<p>However, this syntax does not work with all drivers, and requires modification of all queries.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://java.sun.com/j2se/1.4.2/docs/guide/jdbc/getstart/statement.html">JDBC Specification</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">codec</td><td>a <a class="el" href="classesapi_1_1_codec.html">Codec</a> that declares which database 'input' is being encoded for (ie. MySQL, Oracle, etc.) </td></tr>
    <tr><td class="paramname">input</td><td>the text to encode for SQL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in SQL </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a391493b460a8470432b28630173c2cdf">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a1c3f79c8da8b96b9b832375002fa7a39"></a><!-- doxytag: member="esapi::Encoder::encodeForURL" ref="a1c3f79c8da8b96b9b832375002fa7a39" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a1c3f79c8da8b96b9b832375002fa7a39">esapi::Encoder::encodeForURL</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td>  throw (<a class="el" href="classesapi_1_1_encoding_exception.html">EncodingException</a>)<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode for use in a URL. This method performs <a href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a> on the entire string.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://en.wikipedia.org/wiki/Percent-encoding">URL encoding</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for use in a URL</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in a URL</dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classesapi_1_1_encoding_exception.html">EncodingException</a></td><td>if encoding fails </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#ae9752c570f8e8c0410f55023dfa09f93">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a7fbff87c7ff2ad01ee9d9daf8ddea81c"></a><!-- doxytag: member="esapi::Encoder::encodeForVBScript" ref="a7fbff87c7ff2ad01ee9d9daf8ddea81c" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a7fbff87c7ff2ad01ee9d9daf8ddea81c">esapi::Encoder::encodeForVBScript</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for insertion inside a data value in a Visual Basic script. Putting user data directly inside a script is quite dangerous. Great care must be taken to prevent putting user data directly into script code itself, as no amount of encoding will prevent attacks there.</p>
<p>This method is not recommended as VBScript is only supported by Internet Explorer</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for VBScript</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in VBScript </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#ac4592949cc802d65487b45003b9a179e">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a46781e1e79035e5d91ba19c6b15ba9df"></a><!-- doxytag: member="esapi::Encoder::encodeForXML" ref="a46781e1e79035e5d91ba19c6b15ba9df" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a46781e1e79035e5d91ba19c6b15ba9df">esapi::Encoder::encodeForXML</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XML element. The implementation should follow the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a> from the W3C. </p>
<p>The use of a real XML parser is strongly encouraged. However, in the hopefully rare case that you need to make sure that data is safe for inclusion in an XML document and cannot use a parse, this method provides a safe mechanism to do so.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for XML</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in XML </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#ad9bdda63dbab345535145391ecc3e181">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a95df8e50a41f512ac0eae3d127cbd3c6"></a><!-- doxytag: member="esapi::Encoder::encodeForXMLAttribute" ref="a95df8e50a41f512ac0eae3d127cbd3c6" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a95df8e50a41f512ac0eae3d127cbd3c6">esapi::Encoder::encodeForXMLAttribute</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XML attribute. The implementation should follow the <a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a> from the W3C. </p>
<p>The use of a real XML parser is highly encouraged. However, in the hopefully rare case that you need to make sure that data is safe for inclusion in an XML document and cannot use a parse, this method provides a safe mechanism to do so.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.w3schools.com/xml/xml_encoding.asp">XML Encoding Standard</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for use as an XML attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in an XML attribute </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a7757f800504472516eb63d15eea0be3d">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<a class="anchor" id="a375aae54ac47014bc48ee5d99d63c934"></a><!-- doxytag: member="esapi::Encoder::encodeForXPath" ref="a375aae54ac47014bc48ee5d99d63c934" args="(const String &amp;)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> <a class="el" href="classesapi_1_1_encoder.html#a375aae54ac47014bc48ee5d99d63c934">esapi::Encoder::encodeForXPath</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceesapi.html#ac7e5578df54f144516577c5bb1c833f1">String</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Encode data for use in an XPath query.</p>
<p>NB: The reference implementation encodes almost everything and may over-encode.</p>
<p>The difficulty with XPath encoding is that XPath has no built in mechanism for escaping characters. It is possible to use XQuery in a parameterized way to prevent injection.</p>
<p>For more information, refer to <a href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">this article</a> which specifies the following list of characters as the most dangerous: ^&amp;"*';&lt;&gt;(). &lt;a
 href="<a href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf</a>"&gt;This
 paper&lt;/a&gt; suggests disallowing ' and " in queries.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://www.ibm.com/developerworks/xml/library/x-xpathinjection.html">XPath Injection [ibm.com]</a> </dd>
<dd>
<a href="http://www.packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf">Blind XPath Injection [packetstormsecurity.org]</a></dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>the text to encode for XPath </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>input encoded for use in XPath </dd></dl>

<p>Implemented in <a class="el" href="classesapi_1_1_default_encoder.html#a446686579cdc5d853393c0c901d1906c">esapi::DefaultEncoder</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>esapi/<a class="el" href="_encoder_8h_source.html">Encoder.h</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 21 2012 12:32:26 for OWASP ESAPI for C Plus Plus by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
