<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OWASP ESAPI for C Plus Plus: esapi::RandomPool Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OWASP ESAPI for C Plus Plus
   &#160;<span id="projectnumber">ALPHA</span>
   </div>
   <div id="projectbrief">An API for helping programmers develop more secure business applications in C++</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceesapi.html">esapi</a>      </li>
      <li class="navelem"><a class="el" href="classesapi_1_1_random_pool.html">RandomPool</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">esapi::RandomPool Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="esapi::RandomPool" --><!-- doxytag: inherits="esapi::NotCopyable" -->
<p><code>#include &lt;<a class="el" href="_random_pool_8h_source.html">RandomPool.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for esapi::RandomPool:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classesapi_1_1_random_pool.png" usemap="#esapi::RandomPool_map" alt=""/>
  <map id="esapi::RandomPool_map" name="esapi::RandomPool_map">
<area href="classesapi_1_1_not_copyable.html" alt="esapi::NotCopyable" shape="rect" coords="0,0,121,24"/>
</map>
 </div></div>

<p><a href="classesapi_1_1_random_pool-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_random_pool.html#ab9f3fb91a01b5b10e27317471b3ca402">GenerateBlock</a> (<a class="el" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *bytes, size_t size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_random_pool.html#aecddea70617f78a9d69c1dfc927272d4">Reseed</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_random_pool.html#a483a87aef0dc68f7c66b1b143d4a2204">~RandomPool</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classesapi_1_1_random_pool.html">RandomPool</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classesapi_1_1_random_pool.html#a26533a098d18c2e85fddd556f7c4ae3f">GetSharedInstance</a> ()</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class has no corresponding Java implementation. It is used to fetch entropy from the Operating System for use in/by <a class="el" href="classesapi_1_1_secure_random.html">SecureRandom</a>.</p>
<p>A single instance of the Random Pool exists. Upon startup, the pool will attempt key/sync an internal AES256/OFB cipher by reading from /dev/random if the bytes are available. If not available, the pool will attempt to read from /dev/urandom. If not available the pool will latch a [temporary] error condition.</p>
<p>If <a class="el" href="classesapi_1_1_secure_random.html">SecureRandom</a> attempts fetch bytes while in an error condition, the pool will attempt to clear the error by seeding as described above. If the pool is not able to clear the condition, the pool will throw during the call.</p>
<p>Once the pool acquires bytes from the operating system, the pool will hash the data using SHA-512. The hashed data will be used to key an instance of AES-256/OFB. When <a class="el" href="classesapi_1_1_secure_random.html">SecureRandom</a> fetches bytes from the pool, time data is encrypted under the key. The time data consists of the pair {Performance Counter||Time Of Day}. As output blocks are created, the blocks are used fulfill the request for bytes. In addition, the blocks are fed back into the system for the next encryption operation.</p>
<p>Analysis: since this system uses AES-256/OFB, it is no less secure than the raw entropy bits retrieved from the operating system. That is, generating a stream using AES-256/OFB (keyed with /dev/[u]random) is *not* less secure than using /dev/[u]random or CryptGenRandom directly. </p>

<p>Definition at line <a class="el" href="_random_pool_8h_source.html#l00052">52</a> of file <a class="el" href="_random_pool_8h_source.html">RandomPool.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a483a87aef0dc68f7c66b1b143d4a2204"></a><!-- doxytag: member="esapi::RandomPool::~RandomPool" ref="a483a87aef0dc68f7c66b1b143d4a2204" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classesapi_1_1_random_pool.html#a483a87aef0dc68f7c66b1b143d4a2204">esapi::RandomPool::~RandomPool</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destroy the random pool. </p>

<p>Definition at line <a class="el" href="_random_pool-_shared_8cpp_source.html#l00060">60</a> of file <a class="el" href="_random_pool-_shared_8cpp_source.html">RandomPool-Shared.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab9f3fb91a01b5b10e27317471b3ca402"></a><!-- doxytag: member="esapi::RandomPool::GenerateBlock" ref="ab9f3fb91a01b5b10e27317471b3ca402" args="(byte *bytes, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classesapi_1_1_random_pool.html#ab9f3fb91a01b5b10e27317471b3ca402">esapi::RandomPool::GenerateBlock</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_esapi_common_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>bytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve bytes form the random pool. </p>

<p>Definition at line <a class="el" href="_random_pool-_shared_8cpp_source.html#l00142">142</a> of file <a class="el" href="_random_pool-_shared_8cpp_source.html">RandomPool-Shared.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a26533a098d18c2e85fddd556f7c4ae3f"></a><!-- doxytag: member="esapi::RandomPool::GetSharedInstance" ref="a26533a098d18c2e85fddd556f7c4ae3f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classesapi_1_1_random_pool.html">RandomPool</a> &amp; <a class="el" href="classesapi_1_1_random_pool.html#a26533a098d18c2e85fddd556f7c4ae3f">esapi::RandomPool::GetSharedInstance</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve the shared copy of the random pool. </p>

<p>Definition at line <a class="el" href="_random_pool-_shared_8cpp_source.html#l00119">119</a> of file <a class="el" href="_random_pool-_shared_8cpp_source.html">RandomPool-Shared.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aecddea70617f78a9d69c1dfc927272d4"></a><!-- doxytag: member="esapi::RandomPool::Reseed" ref="aecddea70617f78a9d69c1dfc927272d4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classesapi_1_1_random_pool.html#aecddea70617f78a9d69c1dfc927272d4">esapi::RandomPool::Reseed</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reseed the random pool. The pool will re-key and re-sync itself using bits acquired from the Operating System provided pool. Internally, <a class="el" href="classesapi_1_1_random_pool.html#aecddea70617f78a9d69c1dfc927272d4">Reseed()</a> calls Rekey().</p>
<p>Reseed the random pool. The pool will re-key and re-sync itself using bits acquired from the Operating System provided pool. Internally, <a class="el" href="classesapi_1_1_random_pool.html#aecddea70617f78a9d69c1dfc927272d4">Reseed()</a> calls Rekey(). As an external function, <a class="el" href="classesapi_1_1_random_pool.html#aecddea70617f78a9d69c1dfc927272d4">Reseed()</a> grabs the lock. </p>

<p>Definition at line <a class="el" href="_random_pool-_shared_8cpp_source.html#l00069">69</a> of file <a class="el" href="_random_pool-_shared_8cpp_source.html">RandomPool-Shared.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>esapi/crypto/<a class="el" href="_random_pool_8h_source.html">RandomPool.h</a></li>
<li>src/crypto/<a class="el" href="_random_pool-_shared_8cpp_source.html">RandomPool-Shared.cpp</a></li>
<li>src/crypto/<a class="el" href="_random_pool-_starnix_8cpp_source.html">RandomPool-Starnix.cpp</a></li>
<li>src/crypto/<a class="el" href="_random_pool-_win32_8cpp_source.html">RandomPool-Win32.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 21 2012 12:32:26 for OWASP ESAPI for C Plus Plus by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
